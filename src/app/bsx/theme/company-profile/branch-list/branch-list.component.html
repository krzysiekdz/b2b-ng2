

 <div *ngIf="error" class="m-alert m-alert--outline m-alert--outline-2x alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Błąd!</strong> Nastąpił błąd podczas wczytywania danych z serwera. Spróbuj ponownie za chwilę, a jeśli błąd będzie się powtarzał, skontaktuj się z nami.
</div>

 <div *ngIf="err_delete" class="m-alert m-alert--outline m-alert--outline-2x alert alert-danger alert-dismissible fade show anim1" role="alert">
    <strong>Błąd!</strong> Nastąpił błąd podczas próby usuwania oddziału. Spróbuj ponownie za chwilę, a jeśli błąd będzie się powtarzał, skontaktuj się z nami.
</div>

<div *ngIf="msg_add" class="m-alert m-alert--outline m-alert--outline-2x alert alert-success alert-dismissible fade show anim1" role="alert">
    Nowy oddział utworzony pomyślnie.
</div>

<div *ngIf="msg_edit" class="m-alert m-alert--outline m-alert--outline-2x alert alert-success alert-dismissible fade show anim1" role="alert">
    Oddział <strong>{{msg_edit}}</strong> zmodyfikowany pomyślnie.
</div>

<div   class="m-portlet m-portlet--mobile" >

<div class="m-portlet__head">
	<div class="m-portlet__head-caption">
		<div class="m-portlet__head-title">
			<h3 class="m-portlet__head-text bk">
				Lista oddziałów 
			</h3>
		</div>
	</div>
	<div class="m-portlet__head-tools">
		<ul class="m-portlet__nav">
			<li class="m-portlet__nav-item">
				<div class="m-dropdown m-dropdown--inline m-dropdown--arrow m-dropdown--align-right m-dropdown--align-push" data-dropdown-toggle="hover" aria-expanded="true">
					<a href="javascript:;" class="
m-portlet__nav-link m-portlet__nav-link--icon m-portlet__nav-link--icon-xl m-dropdown__toggle">
						<i class="la la-plus m--hide"></i>
						<i class="la la-ellipsis-h m--font-brand"></i>
					</a>
					<div class="m-dropdown__wrapper">
						<span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
						<div class="m-dropdown__inner">
							<div class="m-dropdown__body">
								<div class="m-dropdown__content">
									<ul class="m-nav">
										<li class="m-nav__section m-nav__section--first">
											<span class="m-nav__section-text">
												Operacje
											</span>
										</li>
										<li class="m-nav__item">
											<a href="javascript:;" class="m-nav__link" (click)="refresh()">
												<i class="m-nav__link-icon flaticon-refresh"></i>
												<span class="m-nav__link-text">
													Odswież listę
												</span>
											</a>
										</li>
										<li class="m-nav__item">
											<a routerLink="//index/company_br/add" class="m-nav__link">
												<i class="m-nav__link-icon flaticon-add"></i>
												<span class="m-nav__link-text">
													Dodaj oddział
												</span>
											</a>
										</li>
										
									</ul>
								</div>
							</div>
						</div>
					</div>
				</div>
			</li>
		</ul>
	</div>
</div>
<div class="m-portlet__body">
	<!--begin: Search Form -->
	<div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
		<div class="row align-items-center">
			<div class="col-xl-8 order-2 order-xl-1">
				<div class="form-group m-form__group row align-items-center">
					
					<div class="col-md-4">
						<div class="m-input-icon m-input-icon--left">
							<input type="text" [(ngModel)]="search_query" (input)="search()" class="form-control m-input " placeholder="Wyszukaj..." id="m_form_search">
							<span class="m-input-icon__icon m-input-icon__icon--left">
								<span>
									<i class="la la-search"></i>
								</span>
							</span>
						</div>
					</div>

				</div>
			</div>
			<div class="col-xl-4 order-1 order-xl-2 m--align-right">
				<a routerLink="//index/company_br/add" class="btn btn-accent m-btn m-btn--custom m-btn--icon m-btn--air">
					<span>
						<i class="flaticon flaticon-add"></i>
						<span>
							Dodaj
						</span>
					</span>
				</a>
				<div class="m-separator m-separator--dashed d-xl-none"></div>
			</div>
		</div>
	</div>
<!--end: Search Form -->



<!--begin: Datatable -->
<div class="m_datatable m-datatable m-datatable--default m-datatable--loaded" id="column_rendering" style=""  >
    <table class="m-datatable__table" id="m-datatable--1335391329591" style="display: block; height: auto; overflow-x: auto;" >
        <thead class="m-datatable__head">
            <tr class="m-datatable__row" style="height: 56px;">
                
                <th data-field="f1" class="m-datatable__cell w1_hide header-sortable" (click)="setOrderBy('pname')"><span class="w1">Nazwa<i *ngIf="orderby=='pname'" class="la" [ngClass]="{'la-arrow-down':!orderbydesc, 'la-arrow-up':orderbydesc}"></i></span>
                </th>
                <th data-field="f2" class="m-datatable__cell w2_hide header-sortable" (click)="setOrderBy('pcity')"><span class="w2">Adres<i *ngIf="orderby=='pcity'" class="la" [ngClass]="{'la-arrow-down':!orderbydesc, 'la-arrow-up':orderbydesc}"></i></span>
                </th>
                <th data-field="f3" class="m-datatable__cell w3_hide" ><span class="w3">Numer telefonu</span>
                </th>
                <th data-field="f4" class="m-datatable__cell w4_hide" ><span class="w4"></span>
                </th> 
            </tr>
        </thead>
        <tbody class="m-datatable__body" style="" *ngIf="!error">


            <tr *ngFor="let b of branches; even as e;" data-row="0" class="m-datatable__row " [ngClass]="{'m-datatable__row--even':e,'m-datatable__row--hover':(mouseOnElement===b)}" style="height: 62px;" (mouseleave)="deselectMouseOnElement()"  (mouseenter)="setMouseOnElement(b)">
              
                <td data-field="f1" class="m-datatable__cell w1_hide clickable" (click)="goToEdit(b.id)" title="Edytuj">
                    <div class="w1" >
                        <div class="m-card-user m-card-user--sm">								
                            <div class="m-card-user__pic w1-photo">									
                                <div class="m-card-user__no-photo {{b.fillstyle}}">
                                    <span>{{b.firstLetter}}</span>
                                </div>
                            </div>
                            <div class="m-card-user__details"> 
                                <span class="m--font-bolder">{{b.name}}</span> 
                                <!-- <a href="" class="m-card-user__email m-link">Bosco-Turner</a>  -->
                            </div>
                        </div>
                    </div>
                </td>
                <td data-field="f2" class="m-datatable__cell w2_hide">
                    <div class="w2">
                    	{{b.postcode}} {{b.city}}<span *ngIf="b.is_street">, {{b.street}} {{b.street_n}}</span>
                    </div>
                </td>
                <td data-field="f3" class="m-datatable__cell w3_hide" >
                    <div class="w3" >   
                        {{b.phone}}
                    </div>
                </td>
                <td data-field="f4" class="m-datatable__cell w4_hide" >
                    <span style="overflow: visible; " class="w4">   
                    	<a href="javascript:;" class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill" title="Pracownicy">
                            <i class="flaticon flaticon-users" (click)="gotoGroup(b.id)" ></i>                      
                        </a>                                   
                        <a routerLink="//index/company_br/edit/{{b.id}}" class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill" title="Edytuj">
                            <i class="la la-edit"></i>                      
                        </a>        
                        <a href="javascript:;" (click)="setBranchToDelete(b)"  class="btn m-btn m-btn--hover-danger m-btn--icon m-btn--icon-only m-btn--pill" title="Usuń" data-toggle="modal" data-target="#m_modal_1" >     
                            <i class="la la-trash" ></i>                           
                        </a>                        
                                                         
                    </span>
                </td>
               
               
               
                
            </tr>
        </tbody>
    </table>



</div>

		<!--end: Datatable -->
	</div>
</div>


 <!--Modal window - usuwanie  -->
<div class="modal fade" id="m_modal_1" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">
                    Usuwanie oddziału
                </h5>
                <button type="button" style="cursor: pointer;" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">
                        &times;
                    </span>
                </button>
            </div>
            <div class="modal-body">
                <p>
                    Czy na pewno chcesz usunąć oddział <span class="m--font-bolder"> {{branchToDelete.name}} </span> ?
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">
                    Anuluj
                </button>
                <button type="button" (click)="delete()" class="btn btn-primary" data-dismiss="modal" >
                    Usuń
                </button>
            </div>
        </div>
    </div>
</div>


